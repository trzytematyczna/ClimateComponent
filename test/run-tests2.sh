#!/bin/bash

printf "PING climate-data\n"
curl -X GET http://127.0.0.1:8000/climate-data/ping
printf "\n\n"

printf "PING topic-analyzer\n"
curl -X GET http://127.0.0.1:8000/topic-analyzer/ping
printf "\n\n"

printf "Topic-Probs climate-data\n"
curl -X GET "http://127.0.0.1:8000/climate-data/topics-probs?DataName=guardian&K=10&JustWordsDF=true" -H  "accept: */*" -d ""
printf "\n\n"


## call to topic-probs with thereshold prob >= 0.005
printf "PIPE climate-data with threshold\n"
curl -X GET "http://127.0.0.1:8000/climate-data/topics-probs?DataName=guardian&K=10&JustWordsDF=true&ProbThreshold=0.005" -H  "accept: */*"
printf "\n\n"


## curl not piping properly
printf "not working - PIPE climate-data with threshold for filtering AND topic-analyzer\n"
curl -X GET "http://127.0.0.1:8000/climate-data/topics-probs?DataName=guardian&K=10&JustWordsDF=true&ProbThreshold=0.005" -H  "accept: */*" | curl -X GET http://127.0.0.1:8000/topic-analyzer/similarity -d '@-'
printf "\n\n"


## curl not piping properly: checking if cat would work - it does not - seems like a arguments handling problem with pipe
## using result saved in /data/topic-probs-from-curl.json
printf "not working -  PIPE json file with results form climate-data AND curl with topic-analyzer\n"
cat topic-probs-from-curl.json | curl -X GET http://127.0.0.1:8000/topic-analyzer/similarity -d '@-'
printf "\n\n"


### check of topic-analyzer/similarity with arguments passed directly as url(same as in /data/topic-probs-from-curl.json file)
### argument passing works, but function returns error: 
# {
#   "error": [
#     "500 - Internal server error"
#   ],
#   "message": [
#     "Error: All columns in a tibble must be 1d or 2d objects:\n* Column `topic_id` is NULL\n"
#   ]
# }

curl -X POST "http://127.0.0.1:8000/topic-analyzer/similarity?topic_word_prob=%7B%22topic_word_prob%22%3A%5B%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22energy%22%2C%22prob%22%3A0.0293%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22carbon%22%2C%22prob%22%3A0.0274%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22australia%22%2C%22prob%22%3A0.0273%7D%2C%7B%22topic_id%22%3A%229%22%2C%22word%22%3A%22trump%22%2C%22prob%22%3A0.0272%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22emissions%22%2C%22prob%22%3A0.0271%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22government%22%2C%22prob%22%3A0.023%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22world%22%2C%22prob%22%3A0.0177%7D%2C%7B%22topic_id%22%3A%228%22%2C%22word%22%3A%22uk%22%2C%22prob%22%3A0.0175%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22warming%22%2C%22prob%22%3A0.0173%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22paris%22%2C%22prob%22%3A0.0171%7D%2C%7B%22topic_id%22%3A%2210%22%2C%22word%22%3A%22people%22%2C%22prob%22%3A0.0161%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22global%22%2C%22prob%22%3A0.0159%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22science%22%2C%22prob%22%3A0.0152%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22global%22%2C%22prob%22%3A0.0149%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22water%22%2C%22prob%22%3A0.0146%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22coal%22%2C%22prob%22%3A0.0144%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22countries%22%2C%22prob%22%3A0.014%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22scientists%22%2C%22prob%22%3A0.014%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22policy%22%2C%22prob%22%3A0.0135%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22power%22%2C%22prob%22%3A0.0134%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22ice%22%2C%22prob%22%3A0.0132%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22companies%22%2C%22prob%22%3A0.0129%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22gas%22%2C%22prob%22%3A0.0125%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22agreement%22%2C%22prob%22%3A0.0123%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22sea%22%2C%22prob%22%3A0.0123%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22energy%22%2C%22prob%22%3A0.0118%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22research%22%2C%22prob%22%3A0.0111%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22reef%22%2C%22prob%22%3A0.0107%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22year%22%2C%22prob%22%3A0.0103%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22australian%22%2C%22prob%22%3A0.0102%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22emissions%22%2C%22prob%22%3A0.0099%7D%2C%7B%22topic_id%22%3A%228%22%2C%22word%22%3A%22people%22%2C%22prob%22%3A0.0096%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22minister%22%2C%22prob%22%3A0.0091%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22temperatures%22%2C%22prob%22%3A0.0091%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22food%22%2C%22prob%22%3A0.009%7D%2C%7B%22topic_id%22%3A%229%22%2C%22word%22%3A%22president%22%2C%22prob%22%3A0.0088%7D%2C%7B%22topic_id%22%3A%228%22%2C%22word%22%3A%22government%22%2C%22prob%22%3A0.0088%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22species%22%2C%22prob%22%3A0.0087%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22cars%22%2C%22prob%22%3A0.0086%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22electric%22%2C%22prob%22%3A0.0084%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22company%22%2C%22prob%22%3A0.0082%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22weather%22%2C%22prob%22%3A0.0079%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22labor%22%2C%22prob%22%3A0.0077%7D%2C%7B%22topic_id%22%3A%229%22%2C%22word%22%3A%22administration%22%2C%22prob%22%3A0.0077%7D%2C%7B%22topic_id%22%3A%228%22%2C%22word%22%3A%22guardian%22%2C%22prob%22%3A0.0077%7D%2C%7B%22topic_id%22%3A%228%22%2C%22word%22%3A%22school%22%2C%22prob%22%3A0.0077%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22coal%22%2C%22prob%22%3A0.0076%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22renewable%22%2C%22prob%22%3A0.0074%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22electricity%22%2C%22prob%22%3A0.0073%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22oil%22%2C%22prob%22%3A0.0073%7D%2C%7B%22topic_id%22%3A%2210%22%2C%22word%22%3A%22world%22%2C%22prob%22%3A0.0072%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22years%22%2C%22prob%22%3A0.0072%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22turnbull%22%2C%22prob%22%3A0.0071%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22water%22%2C%22prob%22%3A0.0071%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22human%22%2C%22prob%22%3A0.0071%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22year%22%2C%22prob%22%3A0.007%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22emissions%22%2C%22prob%22%3A0.007%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22fuel%22%2C%22prob%22%3A0.0069%7D%2C%7B%22topic_id%22%3A%229%22%2C%22word%22%3A%22state%22%2C%22prob%22%3A0.0069%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22solar%22%2C%22prob%22%3A0.0068%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22city%22%2C%22prob%22%3A0.0068%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22earth%22%2C%22prob%22%3A0.0068%7D%2C%7B%22topic_id%22%3A%228%22%2C%22word%22%3A%22action%22%2C%22prob%22%3A0.0067%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22fossil%22%2C%22prob%22%3A0.0067%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22arctic%22%2C%22prob%22%3A0.0066%7D%2C%7B%22topic_id%22%3A%228%22%2C%22word%22%3A%22london%22%2C%22prob%22%3A0.0066%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22coral%22%2C%22prob%22%3A0.0065%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22land%22%2C%22prob%22%3A0.0065%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22international%22%2C%22prob%22%3A0.0065%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22data%22%2C%22prob%22%3A0.0065%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22record%22%2C%22prob%22%3A0.0064%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22scientific%22%2C%22prob%22%3A0.0064%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22study%22%2C%22prob%22%3A0.0063%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22action%22%2C%22prob%22%3A0.0062%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22car%22%2C%22prob%22%3A0.0062%7D%2C%7B%22topic_id%22%3A%228%22%2C%22word%22%3A%22letters%22%2C%22prob%22%3A0.006%7D%2C%7B%22topic_id%22%3A%229%22%2C%22word%22%3A%22environmental%22%2C%22prob%22%3A0.0059%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22world%22%2C%22prob%22%3A0.0059%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22target%22%2C%22prob%22%3A0.0059%7D%2C%7B%22topic_id%22%3A%229%22%2C%22word%22%3A%22obama%22%2C%22prob%22%3A0.0058%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22heat%22%2C%22prob%22%3A0.0058%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22government%22%2C%22prob%22%3A0.0058%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22vehicles%22%2C%22prob%22%3A0.0058%7D%2C%7B%22topic_id%22%3A%2210%22%2C%22word%22%3A%22time%22%2C%22prob%22%3A0.0058%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22world%22%2C%22prob%22%3A0.0057%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22national%22%2C%22prob%22%3A0.0057%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22china%22%2C%22prob%22%3A0.0057%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22university%22%2C%22prob%22%3A0.0056%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22temperature%22%2C%22prob%22%3A0.0056%7D%2C%7B%22topic_id%22%3A%226%22%2C%22word%22%3A%22years%22%2C%22prob%22%3A0.0054%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22great%22%2C%22prob%22%3A0.0054%7D%2C%7B%22topic_id%22%3A%227%22%2C%22word%22%3A%22warming%22%2C%22prob%22%3A0.0053%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22party%22%2C%22prob%22%3A0.0053%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22clean%22%2C%22prob%22%3A0.0053%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22greenhouse%22%2C%22prob%22%3A0.0052%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22wind%22%2C%22prob%22%3A0.0052%7D%2C%7B%22topic_id%22%3A%223%22%2C%22word%22%3A%22industry%22%2C%22prob%22%3A0.0052%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22bleaching%22%2C%22prob%22%3A0.0052%7D%2C%7B%22topic_id%22%3A%225%22%2C%22word%22%3A%22coalition%22%2C%22prob%22%3A0.0052%7D%2C%7B%22topic_id%22%3A%224%22%2C%22word%22%3A%22farmers%22%2C%22prob%22%3A0.0051%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22industry%22%2C%22prob%22%3A0.0051%7D%2C%7B%22topic_id%22%3A%222%22%2C%22word%22%3A%22fuel%22%2C%22prob%22%3A0.0051%7D%2C%7B%22topic_id%22%3A%229%22%2C%22word%22%3A%22oil%22%2C%22prob%22%3A0.0051%7D%2C%7B%22topic_id%22%3A%221%22%2C%22word%22%3A%22rise%22%2C%22prob%22%3A0.005%7D%5D%7D" -H  "accept: */*" -d ""


